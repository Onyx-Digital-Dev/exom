// Authentication view (login/register)

import { Theme } from "theme.slint";
import { TextField, PasswordField, PrimaryButton, SecondaryButton, ErrorText } from "components.slint";

export component AuthView inherits Rectangle {
    in property <string> error-text;

    callback login(string, string);
    callback register(string, string);

    background: Theme.color-bg;

    VerticalLayout {
        alignment: center;
        spacing: Theme.pad-lg;

        Rectangle {
            width: 320px;
            background: Theme.color-panel;
            border-color: Theme.color-border;
            border-width: Theme.border-width;
            border-radius: Theme.radius-md;

            VerticalLayout {
                padding: Theme.pad-xl;
                spacing: Theme.pad-md;

                Text {
                    text: "Exom";
                    color: Theme.color-text;
                    font-size: Theme.text-xl;
                    font-weight: 600;
                    horizontal-alignment: center;
                }

                Text {
                    text: "Hall-based collaboration";
                    color: Theme.color-text-muted;
                    font-size: Theme.text-sm;
                    horizontal-alignment: center;
                }

                Rectangle { height: Theme.pad-md; }

                Text {
                    text: "Username";
                    color: Theme.color-text-muted;
                    font-size: Theme.text-sm;
                }

                username-input := TextField {
                    placeholder: "Enter username";
                }

                Text {
                    text: "Password";
                    color: Theme.color-text-muted;
                    font-size: Theme.text-sm;
                }

                password-input := PasswordField {
                    placeholder: "Enter password";
                    accepted => { root.login(username-input.text, password-input.text); }
                }

                ErrorText {
                    text: root.error-text;
                    horizontal-alignment: center;
                }

                Rectangle { height: Theme.pad-sm; }

                HorizontalLayout {
                    spacing: Theme.pad-md;

                    SecondaryButton {
                        label: "Register";
                        horizontal-stretch: 1;
                        clicked => { root.register(username-input.text, password-input.text); }
                    }

                    PrimaryButton {
                        label: "Login";
                        horizontal-stretch: 1;
                        clicked => { root.login(username-input.text, password-input.text); }
                    }
                }
            }
        }
    }
}
